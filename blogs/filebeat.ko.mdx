---
id: 125
date: 2023-09-12
tags: ["filebeat", "elk"]
title: Filebeat
slug: filebeat
seq: 4
type: interest
language: kr
featureImage: /images/interest/filebeat.png
thumb: /images/interest/filebeat_icon.jpg
github:
demo: http://imcmaster.iptime.org:5601/app/dashboards#/view/79ffd6e0-faa0-11e6-947f-177f697178b8-ecs?_g=(filters:!(),refreshInterval:(pause:!t,value:0),time:(from:'2023-09-12T02:00:00.000Z',to:now))
videoSourceURL:
videoTitle:
excerpt: ê°„í¸í•˜ê²Œ ë©”íŠ¸ë¦­ ë°ì´í„°ë¥¼ ìˆ˜ì§‘.
---

### Filebeat â†’ Elastic Search ì¡°íšŒ

<SearchStep
  items={[
    {
      title: "Intro",
      
      content: (
      <SearchSingle
       
        comment={
          <Diagram schema={{
              nodes: [
              { id: "node-1", content: <Tooltipp
                  content={
                    <div className="px-1 py-2">
                      <div className="text-small font-bold">filebeat.yml setup & run</div>
                      <div className="text-tiny">ymlíŒŒì¼ë‚´ input, outputì„ ì„¤ì •í•œë‹¤.</div>
                      <div className="text-tiny">bin/filebeat -f filebeat.ymlë¡œ ì‹¤í–‰í•œë‹¤.</div>
                    </div>
                  }
                ><img src="/images/interest/filebeat.png" width="120px" alt="pipeline" />
                </Tooltipp>, coordinates: [150, 60] },

              { id: "node-4", content:  <Tooltipp
                  content={
                    <div className="px-1 py-2">
                      <div className="text-small font-bold">Elastic ì¡°íšŒ</div>
                      <div className="text-tiny">filebeat outputìœ¼ë¡œ elasticì„ ì„¤ì •í–ˆìŒ</div>
                      <div className="text-tiny">curlë¡œ ì¡°íšŒ</div>
                    </div>
                  }
                >
                <img src="/images/interest/elastic_icon1.png" width="120px" alt="elastic" />
                </Tooltipp>, coordinates: [400, 60] },
              ],
              links: [
              { input: "node-1", output: "node-4" }
              ],
              }}/>
        }
      ></SearchSingle>
      ),
    },
    {
      title: "Filebeat ì‹¤í–‰",
        content: (
          <>
        <SearchShow
          script="ssh nam cat /home/yknam/sandbox/filebeat/conf/filebeat1_short.yml"
          script1="ssh nam /home/yknam/sandbox/filebeat/filebeat -c /home/yknam/sandbox/filebeat/conf/filebeat1.yml"
          type1="json"
          buttonname="view filebeat,run filebeat"
          comment={
            <>
            run filebeatë¥¼ í´ë¦­í•´ì„œ filebeatë¥¼ ì‹¤í–‰í•˜ì„¸ìš”"ğŸ‘‰
            <Spacee><Chipp color="warning" variant="bordered">filebeat.yml </Chipp>
            <Codee>
             cat ~/filebeat/conf/filebeat1.yml
            </Codee></Spacee> <br />
             <Spacee><Chipp  color="warning" variant="bordered">filebeatì‹¤í–‰</Chipp>
            <Codee>
              ~/filebeat/filebeat -f conf/filebeat1.yml
            </Codee>
          </Spacee> <br />
            <Spacee><Chipp  color="warning" variant="bordered">kill 60ì´ˆí›„</Chipp>
            <Codee>
              sleep 10; kill -9 $(pidof 'filebeat')"
            </Codee></Spacee>
            <Dividerr className="mb-5"/>
            </>
          }
        ></SearchShow>
        </>
      ),
    },

    {
      title: "Elastic Search ì¡°íšŒ",
        content: (
        <SearchShow1
          script="curl get http://imcmaster.iptime.org:9200/filebeat*/_search"
          script1="ssh nam rm -rf /home/yknam/sandbox/filebeat/data;ssh nam curl -X DELETE localhost:9200/filebeat\*"
          buttonname="view,reset"
          type="json"
          comment={
            <>
            resetì„ í´ë¦­ì‹œ filebeat dataì™€ data folderì‚­ì œ ğŸ‘‰<br/>
            <Codee>
              curl get http://localhost:9200/filebeat*/_search
            </Codee>


            </>
          }
        ></SearchShow1>
      ),
        status: "wait",
      disabled: true,
    },

]}
/>

### Filebeat ì„¤ì • (filebeat.yml)

> filebeat.ymlíŒŒì¼ì— input, outputì„ ì„¤ì •í•˜ì—¬ ì‹¤í–‰í•œë‹¤. í•˜ë‚˜ì”©ë§Œ ì„¤ì •, ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.
> input ë°ì´í„° ì†ŒìŠ¤ë¡œ nginx ë¡œê·¸ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ì˜ˆì´ë‹¤. type->log, enable->true,path->/var/log/nginx/access.logë¡œ ì„¤ì •í•œë‹¤.
> output ìœ¼ë¡œ elaticì„ ì„ íƒí–ˆë‹¤. logstashë¥¼ ê±°ì³ filteringí•´ì„œ elasticìœ¼ë¡œ ì „ì†¡í•  ê²½ìš°ì—ëŠ” elasticì„ ì£¼ì„ì²˜ë¦¬í•˜ê³  logstashë¥¼ í™œì„±í™”í•˜ë©´ëœë‹¤.

#### filebeat.yml

<SearchScript filename="filebeatyml" />

ğŸ’¡ filebeatëŠ” í•œë²ˆ ì‹¤í–‰í•œ ë°ì´í„°ëŠ” ë‹¤ì‹œ ì½ì§€ ì•Šê¸° ë•Œë¬¸ì— ìƒˆë¡œ ë°ì´í„°ë¥¼ ì½ìœ¼ë ¤ë©´ dataë””ë ‰í† ë¦¬ë¥¼ ì‚­ì œí•œ í›„ ì‹¤í–‰í•´ì•¼í•¨

### input

<SearchTab
  arr={[
    {
      id: "elasticsearch",
      label: "elasticsearch",
      content: (
        <SearchShow
          script="ssh nam cat /home/yknam/sandbox/filebeat/conf/filebeat1.yml"
          script1="curl get http://imcmaster.iptime.org:9200/filebeat*/_search"
          type1="json"
          comment1={
            <>
            <Chipp>filebeat â†’ elasticsearch</Chipp>
            <Codee>

              curl get http://localhost:9200/filebeat*/_search
            </Codee>
            </>
          }
        ></SearchShow>
      ),
    },
    {
      id: "logstash",
      label: "logstash",
      content: (
        <SearchScript
          filename="mappings_update"
          type="json"
          script1="console.log('hi')"
        ></SearchScript>
      ),
    },
    {
      id: "kafka",
      label: "kafka",
      content:
        "Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",
    },
    {
      id: "sparkstreaming",
      label: "sparkstreaming",
      content:
        "Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",
    },
    {
      id: "redis",
      label: "redis",
      content:
        "Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",
    },

]}
/>

### output

<SearchTab
  arr={[
    {
      id: "elasticsearch",
      label: "elasticsearch",
      content: <SearchShow script="ls -la" script1="ls -la"></SearchShow>,
    },
    {
      id: "logstash",
      label: "logstash",
      content: (
        <SearchScript
          filename="mappings_update"
          type="json"
          script1="console.log('hi')"
        ></SearchScript>
      ),
    },
    {
      id: "kafka",
      label: "kafka",
      content:
        "Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",
    },
    {
      id: "sparkstreaming",
      label: "sparkstreaming",
      content:
        "Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",
    },
  ]}
/>
