---
id: 1251
date: 2023-10-12
tags: ["spark"]
title: Spark Sql
slug: sparksql
seq: 4
type: interest
language: kr
featureImage: /images/interest/spark-sql-big.png
thumb: /images/interest/spark-sql.png
github:
demo:
videoSourceURL:
videoTitle:
excerpt: spark rdd를 추상화하여 dataframe과 dataset, sql로 사용 편의성을 높혔다.
---

### sql view 생성

<SearchAntTab
  arr={[
    {
      id:"test",
      label:"test",
      content:<SearchShow
  id="dvela3"
  script="ssh yknam@namubuntu curl GET http://namubuntu:9200/nginx-2023.10.25/_mapping"
  type="json"
/>
    },
    {
      id: "elasticsearch",
      label: "elasticsearch",
      content: [
         {
      id: "pyspark",
      label: "pyspark",
      icon:<img src="/images/interest/pyspark_icon.png" width="20px"/>,
      content: (
        <SearchScript
          filename="mappings_update"
          type="json"
          script1="console.log('hi')"
        ></SearchScript>
      ),
    },{
       id: "scala",
      label: "scala",
      icon:<img src="/images/interest/scala_icon.png" width="20px"/>,
      content: 
      (
        <SearchShow
        id="file6"
          script="ssh nam cat /home/yknam/sandbox/filebeat/conf/filebeat1.yml"
          script1="curl get http://imcmaster.iptime.org:9200/filebeat*/_search"
          type1="json"
          comment1={
            <>
            <Chipp>filebeat → elasticsearch</Chipp>
            <Codee>

              curl get http://localhost:9200/filebeat*/_search
            </Codee>
            </>
          }
        ></SearchShow>
      ),
    }
      ]
    },

]}
/>

### data sources

### hive

### jdbc

### dataset

> Hdfs 파일 리스트 조회

```python
from pyspark import SparkContext
from pyspark.sql import SparkSession

# sc = SparkContext(appName="sparkRdd")
spark = SparkSession.builder.appName(
    "sparkRdd").master("local[2]").getOrCreate()

# From Mysql table
df_mysql = spark.read.format("jdbc")
   .option("url", "jdbc:mysql://winubuntu:3306/project")
   .option("driver", "com.mysql.jdbc.Driver")
   .option("dbtable", "tablename")
   .option("user", "user")
   .option("password", "password")
   .load()
```

<SearchLabel
  script="/home/yknam/pythonfiles/pyspark/sparkRdd.py"
  txt="spark rdd example"
  port="7878"
/>
