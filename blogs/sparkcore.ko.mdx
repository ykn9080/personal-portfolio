---
id: 1251
date: 2023-10-12
tags: ["spark"]
title: Spark core
slug: sparkcore
seq: 4
type: interest
language: kr
featureImage: /images/interest/spark-big1.png
thumb: /images/interest/spark.png
github:
demo:
videoSourceURL:
videoTitle:
excerpt: 데이터 파이프라인을 관리하는 툴로 정교한 스케쥴기반의 프로세스를 통제한다.
---

### Contents

## spark rdd 기본

    <SearchShow
          id="spark_1"
          script="cat /home/yknam/pythonfiles/pyspark/sparkRdd.py"
          script1="/home/yknam/pythonfiles/pyspark/sparkRdd.py"

        />

## spark rdd to DF

    <SearchShow
          id="spark_2"
          script="cat /home/yknam/pythonfiles/pyspark/sparkRddToDF.py"
          script1="/home/yknam/pythonfiles/pyspark/sparkRddToDF.py"
        />

## spark DataFrame

    <SearchShow
          id="spark_3"
          script="cat /home/yknam/pythonfiles/pyspark/sparkDataframe.py"
          script1="/home/yknam/pythonfiles/pyspark/sparkDataframe.py"

        />
## spark rdd WordCount

    <SearchShow
          id="spark_4"
          script="cat /home/yknam/pythonfiles/pyspark/sparkRddWordCount.py | grep '##'"
          script1="/home/yknam/pythonfiles/pyspark/sparkRddWordCount.py"

        />
## master설정

    <div style={{ float: "right", marginLeft: "20px" }}>
          <img src="/images/interest/spark-master.png" width="400" alt="master" />
          </div>

- **driver only**: worker없이 driver로만 실행됨 local (코어갯수지정)
- **standalone**: spark://localhost:7077로 지정. spark만으로 클러스터를 구성
- **multinode**: resource manager와 node manager를 yarn에 의존한다.
  <div style={{ clear: "both" }} />

## broadcast vs accumulator

    <div style={{ float: "right", marginLeft: "20px" }}>
          <img
              src="/images/interest/sparkcore-broadcast.png"
              width="400"
              alt="broadcastjoin"
            />
          </div>

> 브로드캐스트변수는 파일 사이즈가 작을 경우 driver에서 각 work로 복사하여 사용한다.
> accumulator변수는 각worker에서 공유되는 변수로 변수값이 합쳐진다.

    <div style={{ clear: "both" }} />
### accumulator
    <SearchShow
          id="spark_5"
          script="cat /home/yknam/pythonfiles/pyspark/sparkRddAccumulator.py"
          script1="/home/yknam/pythonfiles/pyspark/sparkRddAccumulator.py" />
### broadcast
    <SearchShow
          id="spark_6"
          script="cat /home/yknam/pythonfiles/pyspark/sparkRddBroadcast.py"
          script1="/home/yknam/pythonfiles/pyspark/sparkRddBroadcast.py" />

## map side join vs shuffle join
  <div style={{ float: "right", marginLeft: "20px" }}>
        <img
              src="/images/interest/sparkcore-shufflejoin.png"
              width="400"
              alt="shufflejoin"
            />
          </div>

> map side join : worker 내에서 조인이 발생되는 경우
> shuffle join: worker간에 shuffle이 발생하여 조인이 일어나는 경우

    <div style={{ clear: "both" }} />
